<!DOCTYPE html>
<html>
  <head>
    <script src="https://unpkg.com/konva@8.3.12/konva.min.js"></script>
    <meta charset="utf-8" />
    <title>Estatica</title>
    <h2 style="margin_down:20; outline: black solid; text-align:center">Aca saldra un enunciado </h2>
    <style>
      body {
        margin_top: 20;
        margin_left: 20;
        overflow: hidden;
        background-color: #f0f0f0;
        outline: black solid
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script>
      var alto = 500
      var largo = 1500
        const stage = new Konva.Stage({
            container: 'container',
            width: largo,
            height: alto
          });
          
          const layer = new Konva.Layer();
          
          var source = new Konva.Circle({
            radius: 4,
            fill: 'grey'
          });
          
          var padding = 30;
          for (var i = 0; i < largo / padding; i++) {
            layer.add(new Konva.Line({
              points: [Math.round(i * padding) + 0.5, 0, Math.round(i * padding) + 0.5, alto],
              stroke: '#000000',
              strokeWidth: 1,
            }));
            
            layer.add(source);
          }
          layer.add(new Konva.Line({points: [0,0,10,10]}));
          for (var j = 0; j < largo / padding; j++) {
            layer.add(new Konva.Line({
              points: [0, Math.round(j * padding), largo, Math.round(j * padding)],
              stroke: '#000000',
              strokeWidth: 0.5,
            }));
          }
          
          
          
          
         
          
          
          
          
          
          let drawingLine = false;
          let line;
          source.on('mousedown', () => {
            drawingLine = true;
            const pos = stage.getPointerPosition();
            line = new Konva.Line({
              stroke: 'black',
              strokeWidth: 7,
              // remove line from hit graph, so we can check intersections
              listening: false,
              points: [source.x(), source.y(), pos.x, pos.y]
            });
            layer.add(line);
          });
          
          stage.on('mouseover', (e) => {
            if (e.target.hasName('target')) {
              e.target.stroke('black');
              layer.draw();
            }
          });
          
          stage.on('mouseout', (e) => {
            if (e.target.hasName('target')) {
              e.target.stroke(null);
              layer.draw();
            }
          });
          
          stage.on('mousemove', (e) => {
            if (!line) {
              return;
            }
            const pos = stage.getPointerPosition();
            const points = line.points().slice();
            points[2] = pos.x;
            points[3] = pos.y;
            line.points(points);
            layer.batchDraw();
          });
          
          stage.on('mouseup', (e) => {
            if (!line) {
              return;
            }
            if (!e.target.hasName('target')) {
              line.destroy();
              layer.draw();
              line = null;
            } else {
              line = null;
            }
            
          });
          
          stage.add(layer);
          layer.draw();
    </script>
  </body>
</html>